<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>插入附件</title>
<meta http-equiv="Content-Type" content="text/html; charset=gbk">
<meta name="robots" content="noindex, nofollow">
<script src="common/fck_dialog_common.js" type="text/javascript"></script>
<link href="common/fck_dialog_common.css" rel="stylesheet" type="text/css" />
<SCRIPT LANGUAGE="JavaScript">
<!--
var oEditor		= window.parent.InnerDialogLoaded() ;
var FCK			= oEditor.FCK ;
var FCKLang		= oEditor.FCKLang ;
var FCKConfig	= oEditor.FCKConfig ;
//alert(oEditor.FCKConfig.ChannelID);

window.onload = function()
{
	window.parent.SetAutoSize( true ) ;
	// Activate the "OK" button.
	window.parent.SetOkButton( true ) ;
}

function Ok()
{
	var urlsrc = attachfrom.thumb.value;
	if (urlsrc.length==0) {
		alert("附件地址不能为空！");
		return false;
	}
	var type = urlsrc.substr(urlsrc.lastIndexOf('.')+1);

	var alttext = attachfrom.hreftext.value;

	if (type =='rar') {
		revalue = "<a href='"+urlsrc+"' target='_blank' title = '"+alttext+"'><IMG SRC='/libs/fckeditor/editor/images/rar.gif'>下载点击此处</a>";
	}else if (type =='zip') {
		revalue = "<a href='"+urlsrc+"' target='_blank' title = '"+alttext+"'><IMG SRC='/libs/fckeditor/editor/images/soft.gif'>下载点击此处</a>";
	}else if (type =='txt'||type=='doc'||type=='wps'||type =='docx') {
		revalue = "<a href='"+urlsrc+"' target='_blank' title = '"+alttext+"'><IMG SRC='/libs/fckeditor/editor/images/txt.gif'>下载点击此处</a>";
	}else {
		revalue = "<a href='"+urlsrc+"' target='_blank' title = '"+alttext+"'><IMG SRC='/libs/fckeditor/editor/images/rar.gif'>下载点击此处</a>";
	}

	FCK.InsertHtml(revalue);
	window.parent.Cancel() ;
}

function BrowseServer(inputname)
{
	var sSuffix = /msie/.test( navigator.userAgent.toLowerCase() ) ? 'ie' : 'gecko' ;
	var time = new Date();
	var timestamp = time.valueOf();
	if(sSuffix=='ie'){
		FCKConfig.BaseName='/admin/file_attach.php?type=file&inputtype=editor&inputname=opener';
		showModalDialog(FCKConfig.BaseName,window,'dialogWidth=600px;dialogHeight=400px;help:yes;status:yes;');	//http://www.ct.com/libs/fckeditor/editor/filemanager/browser/default/browser.html?Type=Flash&Connector=http://www.ct.com/libs/fckeditor/editor/filemanager/connectors/php/connector.php
	}else{
		//window.open(FCKConfig.BaseName,'','');
		FCKConfig.BaseName='/admin/file_attach.php?type=file&inputtype=editor&inputname=opener';
		showModalDialog(FCKConfig.BaseName,window,'dialogWidth=600px;dialogHeight=400px;help:yes;status:yes;');
	}
}

</SCRIPT>
</head>
<body scroll="no" style="OVERFLOW: hidden">

<iframe src='fckblank.html' style="width:1px;height:1px;" name="uploadiframe"></iframe>
<TABLE width="100%">
<TR>
	<Td>
    您可以直接填写附件地址，也可以从服务器上选择文件。	</Td>
</TR>
<FORM METHOD="POST" name="attachfrom" ACTION="">
<TR>
<TD style="border-bottom: 0px solid Gray;padding: 5px 5px 5px 5px;" valign="top"><BR>
附件地址：<BR><INPUT id="opener" TYPE="text" NAME="thumb" style="width:70%">&nbsp;&nbsp;<input id="btnBrowse" onClick="BrowseServer('txtUrl')" type="button" value="浏览服务器"><BR>
附件标题：<BR><INPUT TYPE="text" NAME="hreftext" style="width:90%"><BR>
</TD>
</TR>
</FORM>
</TABLE>

</body>
</html>
